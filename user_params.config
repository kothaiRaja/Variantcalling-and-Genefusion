// ========================== User Parameters Config ========================== //
// This file allows users to override specific parameters without modifying the main configuration.
// To use this file, run:
// nextflow run main.nf -c nextflow_ref_main.config,user_params.config -profile singularity

params {
    // ========================== Base Directories ========================== //
    // Change the directory where output files will be stored.
    outdir = "$baseDir/output"
    resultsdir = "$baseDir/results"
	base_dir = "$baseDir"

    // ========================== Dataset Inputs ========================== //
    // Provide a custom sample sheet (CSV format)
    samplesheet = "/home/kothai/cq-git-sample/Variantcalling-and-Genefusion/data/actual/samples_test.csv"
	reads = "/home/kothai/cq-git-sample/vc_and_gf/reads_star/sample_*_Aligned.sortedByCoord.out.bam"
	strandedness_map = [
    "sample_1": "forward",
    "sample_2": "reverse",
    "sample_3": "unstranded"
]
	

    // ========================== Reference Files ========================== //
    // If using a specific genome, override the reference genome path here.
    reference_genome_path = ""
    reference_genome_index_path = ""
    reference_genome_dict_path = ""

    reference_genome_gtf = ""
    reference_denylist_path = ""

    // ========================== SNP & Indel Variants ========================== //
    variants_snp_path = ""
    variants_snp_index_path = ""

    variants_indels_path = ""
    variants_indels_index_path = ""

    star_genome_index_path = ""

    // ========================== Tool Paths ========================== //
    // Set paths to bioinformatics tools if not using defaults
    snpeff_jar_dir_path = ""
    snpeff_jar_path = "${params.snpeff_jar_dir_path}/snpEff.jar"
    snpeff_config_path = "${params.snpeff_jar_dir_path}/snpEff.config"
    snpeff_db_dir_path = ""
	snpeff_db = '/home/kothai/cq-git-sample/Variantcalling-and-Genefusion/data/actual/Tools/snpEff/snpEff/data'

    // Arriba tool path (for RNA fusion detection)
    arriba_tool_dir_path = ""
	
	arriba_known_fusions = "${baseDir}/sample_ARRIBA/known_fusions_chr22.tsv"  
	arriba_blacklist = "${baseDir}/sample_ARRIBA/blacklist_chr22.tsv"

    // VEP Cache Path
    vep_cache_dir_path = "/home/kothai/cq-git-sample/vc_and_gf/data/test/Tools/VEP/vep_cache"
	
	vep_cache_dir = "/home/kothai/cq-git-sample/vc_and_gf/data/test/Tools/VEP/vep_cache"
	
	
    

   


	
    

    // ClinVar Database Paths (for variant annotation)
    clinvar_path = "/home/kothai/cq-git-sample/Variantcalling-and-Genefusion/data/actual/Tools/VEP/clinvar.vcf.gz"
    clinvartbi_path = "/home/kothai/cq-git-sample/Variantcalling-and-Genefusion/data/actual/Tools/VEP/clinvar.vcf.gz.tbi"
	
	
	//==========================Intervals lisT==================================//
	
	
	select_variants = false
	

    // ========================== Pipeline Behavior ========================== //
    // Enable or disable specific pipeline steps
    concatenate = false				//Concatenate the reads for same sample
	only_qc = false					// Set to true to run only qualtiy control
	skip_star = false
	// ========================= BASE RECALIBRATION BEHAVIOR ========================= //
	skip_base_recalibration = false  

    // ========================== Resource Allocation ========================== //
    // Adjust memory and CPU limits
    max_memory = '32GB'
    max_cpus = 8

    // ========================== Variant Filtering Parameters ========================== //
    gatk_vf_window_size = 35
    gatk_vf_cluster_size = 3
    gatk_vf_qual_filter = 30.0
    gatk_vf_qd_filter = 2.0
    gatk_vf_fs_filter = 60.0
    gatk_vf_mq_filter = 30.0
    gatk_vf_sor_filter = 4.0
    gatk_vf_read_pos_filter = -2.0
    gatk_vf_baseq_filter = -2.0
	

	//=============================User process configurations=============================//
	
	fastqc_raw_cpus = 2
    fastqc_raw_memory = '4 GB'
    fastqc_raw_time = '1h'

    trim_reads_cpus = 4
    trim_reads_memory = '8 GB'
    trim_reads_time = '2h'

	
    gatk_haplotype_caller_cpus = 12
    gatk_haplotype_caller_memory = '24 GB'
    gatk_haplotype_caller_time = '8h'

    gatk_variant_filter_cpus = 8
    gatk_variant_filter_memory = '24 GB'
    gatk_variant_filter_time = '3h'
	
	

    arriba_cpus = 12
    arriba_memory = '24 GB'
    arriba_time = '5h'

    arriba_visualization_cpus = 4
    arriba_visualization_memory = '16 GB'
    arriba_visualization_time = '2h'
	
// ========================= INTERVAL SCATTER SETTINGS ========================= //
scatterintervals = true   // Enable interval scattering
scatter_count    = 3     // Number of intervals to scatter into
	
	

// ================================= STAR Alignment Parameters ================================= //
//Input reads for runing star alone
input_reads = ""

// Resource Allocation
star_cpus                 = 12
star_memory               = '24GB'  
star_time                 = '6h'

// Container Image
star_container            = "https://depot.galaxyproject.org/singularity/star%3A2.7.11a--h0033a41_0"

// STAR Alignment Parameters
star_out_sam_type         = "BAM SortedByCoordinate"   

// Read Filtering
star_alignSJoverhangMin   = 8
star_alignSJDBoverhangMin = 1
star_outFilterMismatchNmax = 999
star_outFilterMatchNmin   = 16
star_outFilterScoreMinOverLread = 0.3

// Chimeric Read Filtering (for Gene Fusion)
star_chimScoreJunctionNonGTAG = -4
star_chimScoreDropMax         = 50
star_chimScoreSeparation      = 10
star_chimOutType			  = "WithinBAM SeparateSAMold"

seq_platform = "ILLUMINA"   // Platform (e.g., ILLUMINA, NOVASEQ)
seq_center = "MySeqCenter"  // Sequencing center name

// ================================= MarkDuplicates Parameters ================================= //

// Input BAM file (Optional: If provided, it skips STAR alignment)
input_bam = ""   

// Resource Allocation
gatk_mark_duplicates_cpus      = 8
gatk_mark_duplicates_memory    = '16GB'
gatk_mark_duplicates_time      = '2h'

// Container Image
gatk_mark_duplicates_container = "https://depot.galaxyproject.org/singularity/gatk4%3A4.4.0.0--py36hdfd78af_0"

// GATK MarkDuplicates Parameters
remove_duplicates      = false  // Set to true if you want to remove duplicates
validation_stringency  = "LENIENT"  // Options: STRICT, LENIENT, SILENT

// Output BAM Naming Format
markduplicates_output_prefix = "marked_duplicates"

// Output Directories
markduplicates_outdir = "./outdir/dedup_bam"

// Metrics File
markduplicates_metrics = "${markduplicates_outdir}/duplication_metrics.txt"

// ==================== User Parameters for SplitNCigarReads ==================== //

split_ncigar_reads_cpus    = 8         // Number of CPU cores to use
split_ncigar_reads_memory  = '16GB'    // Memory allocation
split_ncigar_reads_time    = '3h'      // Maximum execution time

// Container for running SplitNCigarReads
split_ncigar_container     = "https://depot.galaxyproject.org/singularity/gatk4%3A4.4.0.0--py36hdfd78af_0"

// Output directory
split_ncigar_outdir                     = './outdir/split_ncigar'

// ========================= GATK BASE RECALIBRATION SETTINGS ========================= //

gatk_recalibration_cpus    = 8        // Number of CPUs for BaseRecalibrator
gatk_recalibration_memory  = '32GB'   // Memory for BaseRecalibrator
gatk_recalibration_time    = '5h'     // Max execution time for BaseRecalibrator

gatk_applybqsr_cpus        = 8        // Number of CPUs for ApplyBQSR
gatk_applybqsr_memory      = '32GB'   // Memory for ApplyBQSR
gatk_applybqsr_time        = '5h'     // Max execution time for ApplyBQSR

// GATK CONTAINER (Singularity/Docker)
gatk_container = "https://depot.galaxyproject.org/singularity/gatk4%3A4.4.0.0--py36hdfd78af_0"



}

process {
    withName: 'ANNOTATEVARIANTS_VEP' {
        ext.args = [
            '--fork 4',
            '--everything'
        ].join(' ').trim()
    }
}

